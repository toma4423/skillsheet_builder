ITエンジニア向けスキルシート作成Webアプリケーション 基本設計書
1. はじめに
本基本設計書は、ITエンジニア向けスキルシート作成Webアプリケーション「SkillSheet Builder（仮称）」の機能要件及び非機能要件に基づき、システム全体の構成、画面設計、データ設計、及び主要な処理フローを定義する。
2. システム構成概要
本システムは、ユーザーがWebブラウザからアクセスし、入力した情報を基にスキルシート（XLSX形式）を生成するWebアプリケーションである。FastAPIをバックエンドフレームワークとして使用し、Dockerコンテナとして動作させ、GCP Cloud Runにデプロイすることを想定する。データはサーバー側に永続化しない。
2.1. 全体アーキテクチャ
コード スニペット
graph TD
    A[ユーザー (Webブラウザ)] -->|HTTP/HTTPS| B(FastAPIアプリケーション on Cloud Run)
    B -->|ファイル生成| C[XLSXファイル (ダウンロード)]
    C --> A
    A -->|ファイルアップロード (XLSX)| B
    B -->|データ解析| A


2.2. 主要コンポーネント
フロントエンド: HTML, CSS, JavaScript (React/Vue.jsなどのフレームワークは現時点では検討外とし、素のJSまたはJinja2テンプレートを利用したサーバーサイドレンダリングを想定)
バックエンド: FastAPI (Python 3.11)
XLSX操作ライブラリ: openpyxl
パッケージ管理: uv
コンテナ化: Docker
デプロイ先: GCP Cloud Run
3. 画面設計
3.1. 画面一覧
画面ID
画面名
概要
備考
SCR001
トップページ
アプリケーションの説明と免責事項、操作選択


SCR002
スキルシート編集
スキルシートの各情報を入力するメイン画面
新規作成/ファイル読み込み時の入力フォーム
SCR003
プレビュー
入力内容の簡易プレビュー表示



3.2. 画面フロー
コード スニペット
graph TD
    A[アクセス] --> B(SCR001: トップページ)
    B -->|新規作成| C(SCR002: スキルシート編集 - 初期表示)
    B -->|ファイルから読み込み| D(SCR002: スキルシート編集 - 読み込み反映)
    C --> E(SCR003: プレビュー)
    D --> E
    E -->|XLSX出力| F[XLSXファイルダウンロード]
    E -->|編集に戻る| C
    E -->|終了| B
    C -->|終了| B


3.3. 画面詳細
3.3.1. SCR001: トップページ
目的: ユーザーにアプリケーションの概要を説明し、次の操作を選択させる。
レイアウト要素:
アプリケーションタイトル
アプリケーション概要説明文
免責事項（個人情報を保存しない旨など）
「新規作成」ボタン
「ファイルから読み込み」ボタン
3.3.2. SCR002: スキルシート編集
目的: ユーザーがスキルシートの各情報を入力・編集する。
レイアウト要素:
入力フォームエリア:
基本情報セクション:
氏名 (テキスト入力、入力例: 山田 太郎)
ふりがな (テキスト入力、入力例: やまだ たろう)
性別 (ラジオボタン: 男性, 女性, その他, 回答しない)
年齢 (数値入力、入力例: 30)
最寄駅 (テキスト入力、入力例: 新宿)
実務経験 (数値入力、単位: 年、入力例: 5)
自己PR (テキストエリア、文字数制限表示)
主要技術 (テキストエリア、文字数制限表示、箇条書き推奨)
保有資格 (テキストエリア、文字数制限表示、箇条書き推奨)
対応可能業務セクション:
各業務項目（顧客折衝, 調査分析, 要件定義, ..., SV運用）に対し、ドロップダウンリストで「o」または「-」を選択。
例: 顧客折衝: [ドロップダウンリスト (o / -)]
職務経歴セクション:
「経歴追加」ボタン: クリックすると新しい職務経歴入力ブロックが追加される。
各職務経歴ブロックは、以下の項目を持つ。
業務開始年月 (年月選択プルダウン、例: 2020年04月)
業務終了年月 (年月選択プルダウン、例: 2022年03月 / 「現在」チェックボックス)
業務期間 (自動表示、例: 2年0ヶ月)
業務概要（及び業務内容） (テキストエリア)
ポジション (テキスト入力、例: SE)
規模（人数） (数値入力、単位: 名)
担当業務 (テキストエリア、箇条書き推奨)
技術環境 (テキストエリア、箇条書き推奨、内容例: OS: Linux, 言語: Python, FW: FastAPI, DB: PostgreSQL, Cloud: AWS, Tool: Git)
当該職務経歴ブロックの「削除」ボタン
操作ボタン:
「プレビュー表示」ボタン
「終了」ボタン（トップページに戻る）
3.3.3. SCR003: プレビュー
目的: 入力された内容をXLSX出力時のイメージに近い形で表示し、ユーザーが最終確認を行う。
レイアウト要素:
入力内容の簡易的なHTML表示（Excelレイアウトの再現は完全ではないが、視覚的に確認できるよう整形）
「XLSX出力」ボタン
「編集に戻る」ボタン
「終了」ボタン（トップページに戻る）
4. データ設計
4.1. データモデル
アプリケーション内部で扱うスキルシートのデータ構造を定義する。FastAPIのPydanticモデルで表現することを想定。
Python
# スキルシート全体のデータモデル
class SkillSheetData(BaseModel):
    basic_info: BasicInfo
    possible_tasks: PossibleTasks
    career_history: List[CareerHistoryEntry]

# 基本情報データモデル
class BasicInfo(BaseModel):
    name: str
    kana: str
    gender: str # "男性", "女性", "その他", "回答しない"
    age: int
    nearest_station: str
    experience_years: int
    self_pr: str
    main_technologies: str
    qualifications: str

# 対応可能業務データモデル
class PossibleTasks(BaseModel):
    customer_negotiation: str # "o" or "-"
    research_analysis: str   # "o" or "-"
    requirement_definition: str # "o" or "-"
    # ... 他の業務項目も同様に定義

# 職務経歴エントリデータモデル
class CareerHistoryEntry(BaseModel):
    start_date: date # YYYY-MM-DD (年月の情報のみ利用)
    end_date: date # YYYY-MM-DD (年月の情報のみ利用) または "現在"を表す特殊値
    duration_months: int # 自動計算
    overview: str
    position: str
    scale_members: int
    responsibilities: str
    tech_environment: str


4.2. XLSXファイルフォーマット
ご提供いただいた画像に基づき、以下のシート構成と主要なセルの配置を想定する。
シート名: 例: 「職務経歴書」
A1セル: 「職務経歴書」タイトル
B2セル: 「氏名」
D2セル: 氏名データ
B3セル: 「生年月日」
D3セル: 生年月日データ (入力は年齢だが、便宜上計算して表示するか、固定文字列「年齢：XX歳」とするか検討)
B4セル: 「最寄駅」
D4セル: 最寄駅データ
B5セル: 「実務経験」
D5セル: 実務経験データ（例: 5年）
A7セル: 「自己PR」タイトル（セル結合あり）
B8セル以降: 自己PR内容（複数行、セル結合あり）
Axxセル: 「主要技術」タイトル（セル結合あり）
Bxxセル以降: 主要技術内容（複数行、セル結合あり）
Ayyセル: 「保有資格」タイトル（セル結合あり）
Byyセル以降: 保有資格内容（複数行、セル結合あり）
対応可能業務の表:
特定の行（例: B列）に「顧客折衝」「調査分析」などの業務項目名
隣接する列（例: C列）に「o」または「-」の記号
表形式で罫線を引く。
職務経歴セクション:
各職務経歴ブロックは、指定された開始行から始まり、必要な行数分を確保する。
業務期間: A列（期間開始）、B列（期間終了）、C列（期間合計）
プロジェクト概要: D列〜F列（結合セル）
担当フェーズ・役割: G列〜H列（結合セル）
規模: I列
担当業務: A列〜C列（結合セル、次の職務経歴開始まで）
技術環境: D列〜I列（結合セル、次の職務経歴開始まで）
技術環境内は「OS: XXX\n言語: YYY」のように改行区切りで表示。
罫線とセル結合:
提供画像に基づいて、必要な箇所に罫線を設定し、セル結合を行う。
Excelのスタイル（フォント、サイズ、太字、背景色など）も可能な範囲で再現する。
5. 主要処理フロー
5.1. 新規作成/ファイル読み込み
ユーザーがSCR001で「新規作成」または「ファイルから読み込み」を選択。
「新規作成」の場合：SCR002を初期状態で表示。
「ファイルから読み込み」の場合：
ファイル選択ダイアログを表示し、XLSXファイルを選択させる。
選択されたXLSXファイルをFastAPIバックエンドにアップロード（一時ファイルとして処理）。
FastAPIはopenpyxlなどを使用してXLSXファイルを読み込み、セル情報をパース。
パースしたデータをSkillSheetDataモデルに変換し、フロントエンドに返却。
フロントエンドは受け取ったデータでSCR002の入力フォームを埋める。
エラーハンドリング: 不正なファイル形式や破損したファイルの場合、エラーメッセージを表示し、SCR002を初期状態で表示。
5.2. 経歴追加/削除
SCR002でユーザーが「経歴追加」ボタンをクリック。
フロントエンドはJavaScriptで新しい職務経歴入力ブロックを動的にDOMに追加。
「削除」ボタンクリック時も同様に、該当ブロックをDOMから削除。
5.3. プレビュー表示
SCR002でユーザーが「プレビュー表示」ボタンをクリック。
フロントエンドは現在の入力フォームの内容を収集し、SkillSheetDataモデルに整形。
整形したデータをFastAPIバックエンドに送信。
FastAPIはデータを受け取り、それを基に簡易的なHTMLを生成（テンプレートエンジン利用を検討）。
生成されたHTMLをフロントエンドに返し、SCR003に表示する。
5.4. XLSXファイル出力
SCR003でユーザーが「XLSX出力」ボタンをクリック。
フロントエンドは現在の入力フォームの内容（またはプレビュー生成時と同じデータ）を収集し、SkillSheetDataモデルに整形。
整形したデータをFastAPIバックエンドに送信。
FastAPIはデータを受け取り、openpyxlを使用して新しいWorkbookオブジェクトを作成。
SkillSheetDataの内容に基づき、所定のセルにデータを書き込み、セルの結合、罫線、フォントスタイルなどを設定。
Workbookをメモリ上でXLSX形式のバイナリデータとして保存。
バイナリデータをHTTPレスポンスとしてフロントエンドに返す（Content-Type: application/vnd.openxmlformats-officedocument.spreadsheetml.sheet）。
フロントエンドは受け取ったデータをファイルとしてダウンロードさせる。
6. エラーハンドリング
入力フォームのバリデーションエラー：必須項目未入力、数値以外の入力などに対し、リアルタイムまたはフォーム送信時にエラーメッセージを表示。
ファイルアップロードエラー：ファイル形式不正、サイズ超過などに対し、ユーザーに分かりやすいメッセージを表示。
バックエンド処理エラー：予期せぬサーバーエラーが発生した場合、一般的なエラーメッセージを表示し、ログに詳細を記録。
7. 技術要素詳細
FastAPI: ルーティング、リクエストバリデーション（Pydantic）、レスポンス生成。
uv: 依存関係の管理、高速なパッケージインストール。
openpyxl: XLSXファイルの読み込み、書き込み。
セルの値設定、セルの結合 (merge_cells), セルのスタイル設定 (Border, Side, Font, Alignmentなど)。
Docker: 開発環境の統一とデプロイの容易化。
GCP Cloud Run: サーバーレスコンテナ実行環境として、スケーラビリティと運用の容易性を提供。


